function bindElementSlider(){$("#alsoBuy").get(0)&&$("#alsoBuy .item").each(function(){for(var e=$(this),t=1;t<4;t++)(e=e.next()).length||(e=$(this).siblings(":first")),e.children(":first-child").clone().addClass("cloneditem cloneditem-"+t).appendTo($(this))}),$("#pslider").get(0)&&($("#psslider").get(0)?($("#psslider .item").each(function(){for(var e=$(this),t=1;t<4;t++)(e=e.next()).length||(e=$(this).siblings(":first")),e.children(":first-child").clone().addClass("cloneditem cloneditem-"+t).appendTo($(this))}),$("#pslider").on("slide.bs.carousel",function(e){var t=parseInt($(e.relatedTarget).attr("data-slide-to"));isNaN(t)||$("#psslider").carousel(t)})):$(".psthumbs").get(0)&&$("#pslider").on("slide.bs.carousel",function(e){var t=parseInt($(e.relatedTarget).attr("data-slide-to"));isNaN(t)||$(".psthumbs").find(".item").removeClass("active").eq(t).addClass("active")}),$(".psthumbs").get(0)&&$(".psthumbs img").click(function(){var e=parseInt($(this).attr("data-slide-to"));isNaN(e)||$("#pslider").carousel(e)})),$("a.lightbox").on("click",function(e){return e.preventDefault(),$(this).ekkoLightbox({alwaysShowClose:!0,onNavigate:function(e,t){$("#pslider").get(0)&&$("#pslider").carousel(t),$("#psslider").get(0)&&$("#psslider").carousel(t)}}),!1})}function bindModelCollapse(){$(".models-collapse").get(0)&&$(".models-collapse p:last-of-type").bind("click",function(){$(this).parent().hasClass("models-expanded")?$(this).parent().removeClass("models-expanded"):$(this).parent().addClass("models-expanded")})}function bindQuickPhoneForm(){if($(".btn-oneclick").get(0))var e="/ajax_cart/fastoder.php";else e="/ajax_cart/preorder.php";var t=$("#oqPhoneOrder").attr("data-product-id");if(t=parseInt(t),!isNaN(t)){phonePlaceholder="+79_________",phoneMask="+79000000000",$("#oqQuickPhone").attr("autocomplete",!1),$("#oqQuickPhone").attr("placeholder",phonePlaceholder);var a={onKeyPress:function(e,t,a,r){$(a).get(0)&&0===$(a).val().indexOf("+78")&&$(a).val($(a).val().replace("+78","+79"))}};$("#oqQuickPhone").mask(phoneMask,a),$("#oqCallbackme").bind("click",function(){if($(this).removeClass("btn-danger").addClass("btn-default").parents(".form-group").removeClass("has-error"),""==$("#oqQuickPhone").val())$(this).addClass("btn-danger").removeClass("btn-default").parents(".form-group").addClass("has-error"),$("#oqQuickPhone").focus();else{var a=$("#oqQuickPhone").val(),r="no-reply@"+location.hostname;r=$.trim(r),$("#oqError .errors")[0].innerHTML="",$("#oqOrder,#oqError").addClass("hidden"),$("#oqCallbackme").attr("disabled",!0),jQuery.ajax({url:e,method:"POST",dataType:"json",async:!0,processData:!0,data:{PRODUCT_ID:t,PAYER_NAME:"Уточнить",PAYER_PHONE:a,PAYER_EMAIL:r}}).done(function(e){if(e.ERROR){if($("#oqError").removeClass("hidden"),$("#oqCallbackme").attr("disabled",!1),e.ERROR&&e.ERROR.length)for(var a=0;a<e.ERROR.length;a++)$("#oqError .errors")[0].innerHTML+='<div class="alert alert-danger text-left" role="alert"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span><span class="sr-only">Error:</span> '+e.ERROR[a]+"</div>"}else if(e.ORDER_ID){$.cookie("BITRIX_SM_ispreodered"+t,1),$(".btn-preorder-"+t).attr("disabled",!0);var r=$.trim($("#oqResultOk").text());$("#oqOrder")[0].innerHTML=r.replace("#",e.ORDER_ID),$("#oqOrder").removeClass("hidden")}})}})}}function bindGoogleDataLayer(){jQuery(document).on("yacounter21503785inited",function(){if($("#product-item").get(0)&&1==$("#product-item").attr("data-hasprice")){var e=$("#product-item").attr("data-product-id"),t=$.trim($('h1[itemprop="name"]',$("#product-item")).text()),a=$.trim($('meta[itemprop="price"]',$("#product-item")).attr("content")),r=$.trim($('meta[itemprop="manufacturer"]',$("#product-item")).attr("content")),o=$.trim($('meta[itemprop="category"]',$("#product-item")).attr("content")),i=$.trim($('meta[itemprop="priceCurrency"]',$("#product-item")).attr("content")),s=[{id:e,name:t,price:a}];""!=o&&(s[0].category=o),""!=r&&(s[0].brand=r),window.dataLayer=window.dataLayer||[],dataLayer.push({ecommerce:{currencyCode:i,detail:{products:s}}})}})}$(function(){bindElementSlider(),bindModelCollapse(),bindQuickPhoneForm(),bindGoogleDataLayer(),$('[data-toggle="popover"]').popover()});